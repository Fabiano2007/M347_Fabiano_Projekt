# A

## Teil a)
![Screenshot 2025-06-02 133643](https://github.com/user-attachments/assets/076777fe-9df1-470d-8562-d0775b7c60b3)
![Screenshot 2025-06-02 134217](https://github.com/user-attachments/assets/bc1a6b29-e34c-49ea-9884-db1d770dfc57)

## Teil b)
![Screenshot 2025-06-02 135550](https://github.com/user-attachments/assets/a8acf9e7-7ce8-4b2b-8940-3149ac9d5eec)
![Screenshot 2025-06-02 135237](https://github.com/user-attachments/assets/fef2a4a6-0db9-4342-ada5-3b926971fbb5)


# B
![Screenshot 2025-06-02 154103](https://github.com/user-attachments/assets/77485bfe-61c7-444f-8531-1ec3846fcafd)
![Screenshot 2025-06-02 154120](https://github.com/user-attachments/assets/ce6be62d-3a68-4c25-a650-d6e554c6dced)


# Aufgabe B Verbesserung

![Screenshot 2025-06-28 194359](https://github.com/user-attachments/assets/cdfeeda6-d4d4-42de-b9a4-0bbd462db72b)
![Screenshot 2025-06-28 194327](https://github.com/user-attachments/assets/7451e8af-cbb7-4b48-ac91-c851fb0eb4b1)

## Cloud Init File

#cloud-config
users:
  - name: ubuntu
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users, admin, docker
    home: /home/ubuntu
    shell: /bin/bash
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCUBo+qnNu5xxM9vfz4C04M36FHxHNrEMdm5TkFj1/SfVtqunlUOeMpu7nFCZZKnX8HYwf/MkjcBiTYAgncxku8grwl6XuW/pcvmb6/ghSIaw4xtRRSzit7omqJ5d8kXB3+Nd1aaMHsjfly4nkaqswhySVXQqr8Hw6DbWVw8jLLVKEE+5NZHY33hJkhJwK4blCllsGpmQaKi1qxjsN0hZOWNK01iJAydwD8t2xJ0NOYbq8Qas5IyPnRN7SPxvEhIP6WLQ6Ym6Dmf8FwNW1cHLTKabgjzt5f/HKUkKS89dPd3fn4nnFli1BOMECGUIvVlOw2pQNri7+04OOfn2FGlqr5
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1YJ3erzZCeoQ6m1HhUQGHLUEuRNvTFR/S+iottsVoLYaywWbYpjyETJKrwxi/pSPnl10GurzGptymz0hjNMtOje5Crxy/dS0azIM6jn84kUL3p5Tk9vgvuUwWYZoMxyZrqYp8rDGcKm/yhx/hU2p4u6RtTsDyEVupBL2WRmecXEcBEk8gL9poY51XJYUCWFx/gepQ7PvDrbJXLLpucdcjlcI8cEWcez7l+tRbdvk2K44EDrNx3S6lhAHekyodCNZbcbSvyhXYQukM/Zs2IZo530LRfghyXEYr5tvUzdl6nNy30SAN173HY68BgarEyyE5yURZU+wuub/27gY3lmVn

package_update: true
package_upgrade: true

runcmd:
  - apt update
  - apt install -y docker.io docker-compose
  - mkdir -p /home/ubuntu/kn04
  - |
    cat <<EOF > /home/ubuntu/kn04/docker-compose.yml
    version: '3.9'
    services:
    
  m347-kn04b-db:
    image: fabiano4392/m347:kn02b-db
    container_name: kn04-db
    networks:
      kn04-net:
        ipv4_address: 172.20.15.10

  web:
    image: fabiano4392/m347:kn02b-web
    container_name: kn04-web
    ports:
      - "80:80"
    depends_on:
      - m347-kn04b-db
    networks:
      kn04-net:
        ipv4_address: 172.20.15.11
    environment:
      DB_HOST: m347-kn04b-db
      DB_NAME: testdb
      DB_USER: root
      DB_PASS: root

    networks:
      kn04-net:
        driver: bridge
        ipam:
          config:
            - subnet: 172.20.0.0/16
              ip_range: 172.20.15.0/24
              gateway: 172.20.15.254
    EOF
  - docker-compose -f /home/ubuntu/kn04/docker-compose.yml up -d




## Liste der Befehle, die docker compose up ausführt und deren Erklärungen
Der Befehl docker compose up führt automatisch eine Reihe von Aktionen durch:

Liest die docker-compose.yml Datei
→ Analysiert alle Services, Netzwerke und Volumes.

Erstellt Netzwerke
→ Benutzerdefinierte Netzwerke wie kn04-net werden angelegt.

Baut Images (optional mit --build)
→ Falls build: verwendet wird, wird das angegebene Dockerfile ausgeführt.

Startet Container
→ Container werden im Hintergrund oder im Vordergrund ausgeführt (je nach Flag).

Setzt Umgebungsvariablen
→ Werte wie DB_HOST, DB_USER usw. werden gesetzt.

Stellt Verbindungen zwischen Containern her
→ Wenn Container im selben Netzwerk sind, können sie per Hostnamen kommunizieren.

Öffnet Ports auf dem Host
→ Z. B. 8085:80 für den Webserver.

## Erklärung wieso der Fehler auftritt (Teil b und Cloud)
Der Fehler "php_network_getaddresses: getaddrinfo failed" tritt auf, weil der Webserver den Datenbank-Container nicht finden kann. Das liegt an:

fehlendem oder falsch konfiguriertem gemeinsamen Docker-Netzwerk

oder daran, dass bei veröffentlichten Images Umgebungsvariablen (z. B. DB_HOST) nicht übergeben wurden oder andere Werte erwarten

## Lösung
Sicherstellen, dass beide Container im gleichen benutzerdefinierten Netzwerk laufen

In docker-compose.yml oder Cloud-Init:

Ein Netzwerk mit ipam.config definieren

Beide Services explizit mit diesem Netzwerk verbinden

Richtige Hostnamen (Service-Namen) als DB_HOST setzen




